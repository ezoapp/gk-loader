define(function(){"use strict";function keys(){var e=Object.keys||function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t};return e.apply(null,arguments)}function e(e){return e.replace(/<!--[\s\S]*?-->/gm,"").replace(/>\s+</gm,"><")}function t(e){return e.replace(/\s*(\r\n|\n|\r)\s*/gm,"")}function n(e,t,n,r){return t=f(t,e+"/../"),t=t.substr(0,t.length-n.length-1),(r||"")+t}function r(e){return"function registerElement(n,c){"+keys.toString()+gk.toString()+"$.gk.registry(n,gk('"+e+"',c));}"}function i(e){return t(e.script)+"define("+JSON.stringify(e.deps)+", function("+e.names.join()+"){"+e.moduleText+"});"}function gk(e,t){var n=keys(t||{}),r=function(){for(var e=0,r=n.length;r>e;e+=1)this[n[e]]=t[n[e]]};return{template:e,script:r}}function u(e,t){var r=function(e,n){t.deps.push(e),n&&t.names.push(n)};e.each(function(e,i){var u=i.getAttribute("path"),c=i.getAttribute("src"),o=i.getAttribute("var");u?r(u,o):c?(c=n(t.moduleId,c,"js"),r(c,o)):t.script+=i.text})}function c(e,t){e.each(function(e,r){var i=r.getAttribute("href");i&&t.deps.push(n(t.moduleId,i,"html","@html!"))})}function o(r,i){var u;r.length&&(r=$("<div>"+r[0].innerHTML+"</div>"),u=r.children("link"),u.each(function(e,t){var r=t.getAttribute("href");r&&i.deps.push(n(i.moduleId,r,"css","@css!"))}),u.remove(),i.template=e(t(r[0].innerHTML)))}function l(e,t){t.moduleText=r(t.template)+(e.length?e[0].text:"")}var s=".html",a=registryGK.urllib,d=a.normalize,f=a.absolute;return{load:function(e,t,n){t(["@text!"+e+s],function(t){var r=$("<div>"+t+"</div>"),s=r.children("script"),a=r.children("link"),d=r.children("element"),f=d.children("template"),m=d.children("script"),p={deps:["require","exports","module"],names:["require","exports","module"],moduleId:e,template:"",moduleText:"",script:""};u(s,p),c(a,p),o(f,p),l(m,p),n.fromText(i(p))})},normalize:d}});