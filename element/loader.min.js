define(["module"],function(e){"use strict";function t(e){return e.replace(/<!--[\s\S]*?-->/gm,"").replace(/>\s+</gm,"><")}function n(e){return e.replace(/\s*(\r\n|\n|\r)\s*/gm,"")}function r(e,t,n){return t=p(t,e+"/../"),t.substr(0,t.length-n.length-1)}function i(e,t){var n=function(e,n){t.deps.push(e),n&&t.vars.push(n)};e.each(function(e,i){var u=i.getAttribute("path"),l=i.getAttribute("src"),o=i.getAttribute("var");u?n(u,o):l?(l=r(t.moduleId,l,"js"),n(l,o)):t.script+=i.text})}function u(e,t){e.each(function(e,n){var i=n.getAttribute("rel"),u=n.getAttribute("href");u&&("import"===i?t.deps.push("@html!"+r(t.moduleId,u,"html")):"stylesheet"===i&&t.deps.push("@css!"+r(t.moduleId,u,"css")))})}function l(e,r){var i;e.length&&(e=g("<div>"+e[0].innerHTML+"</div>"),i=e.children("link"),u(i,r),i.remove(),r.template=t(n(e[0].innerHTML)))}function o(e,t){t.moduleText=v.registerElement(t.template)+(e.length?e[0].text:"")}function c(e){return"(function(){"+v.moduleInfo(e.moduleId)+n(e.script)+";define("+JSON.stringify(e.deps)+",function("+e.vars.join()+"){"+e.moduleText+"})}())"}function s(e,t){var n=g("<div>"+e+"</div>"),r=n.children("script"),s=n.children("link"),d=n.children("element"),m=d.children("template"),f=d.children("script");return i(r,t),u(s,t),l(m,t),o(f,t),c(t)}var d=".html",m=e.config(),f=m.lib,a=f.normalize,p=f.absolute,g=f.$,h=g.gk,v={registerElement:function(e){return";function registerElement(n,c){$.gk.registerElement(n,'"+e+"',c)}"},moduleInfo:function(e){return";var module="+JSON.stringify({name:e})+";"}};return h.registerElement=function(e,t,n){h.createTag([e]),h.registry(e,{template:t,script:function(){for(var e=Object.keys(n||{}),t=0,r=e.length;r>t;t+=1)this[e[t]]=n[e[t]]}})},{load:function(e,t,n){t(["@text!"+e+d],function(t){var r={deps:["require","exports","module"],vars:["require","exports","module"],moduleId:e,template:"",moduleText:"",script:""};n.fromText(s(t,r))})},normalize:a,pluginBuilder:"./builder"}});