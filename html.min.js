define(["module"],function(e){"use strict";function t(){return window.DOMParser?new DOMParser:void 0}function r(e){if(a)return a.parseFromString("<body>"+e+"</body>","text/html").querySelector("body");var t=document.createElement("div");return t.style.display="none",document.body.appendChild(t),t.innerHTML=e.replace(s,"<$1"+f),t}function n(e){a||document.body.removeChild(e)}function i(e,t){e.each(function(e,r){var n=r.getAttribute("href");n&&t.deps.push(y(n,t.moduleId+"/../")),r.parentNode.removeChild(r)})}function o(e,t){var r,n=[],i={},o={context:"gk"};if(e.each(function(e,r){var i=r.getAttribute("src");i?n.push(y(i,t.moduleId+"/../")):t.script+=T(r).text()}),r=n.length,r&&(t.deps.push(n[r-1]),r>1)){for(var u=r-1;u>0;u-=1)i[n[u]]=[n[u-1]];o.shim=i,t.script="requirejs.config("+JSON.stringify(o)+");"+t.script}}function u(e,t){var r=T("<div>"+e.html()+"</div>");i(r.find("link"),t),t.template=x(b(r.html())),e.html(r.html())}function l(e,t){t.moduleText=k.requireVariables(t.deps)+";"+k.registerElement(t.template)+(e.length?e.text():"")}function c(e){var t="(function(){"+k.moduleInfo(e.moduleId)+";"+b(e.script)+";define(function("+e.vars.join()+"){"+e.moduleText+"})}());";return t=t.replace(p,"script")}function d(e,t){var d=r(e),m=T(d),a=m.children(f),s=m.find("link"),p=m.children("element"),h=p.children("template"),g=p.children(f);return i(s,t),o(a,t),u(h,t),l(g,t),n(d),c(t)}!function(e){if(e){var t=e.prototype,r=t.parseFromString;try{if((new e).parseFromString("","text/html"))return}catch(n){}t.parseFromString=function(e,t){if(/^\s*text\/html\s*(?:;|$)/i.test(t)){var n=document.implementation.createHTMLDocument("");return e.toLowerCase().indexOf("<!doctype")>-1?n.documentElement.innerHTML=e:n.body.innerHTML=e,n}return r.apply(this,arguments)}}}(window.DOMParser);var m=".html",a=t(),s=/<(\/|)script/g,f=a?"script":"gk__script__tag",p=new RegExp(f,"g"),h=e.config(),g=h.lib,v=g.normalize,y=g.loadUrl,x=g.trimHtml,b=g.trimNewline,w=g.each,T=g.$,E=T.gk;E.createTag(["element","template",f]);var k={requireVariables:function(e){var t=[];return w(e,function(e){t.push('require("'+e+'")')}),t.join(";")},registerElement:function(e){return"function registerElement(n,c){$.gk.registerElement(n,'"+e+"',c)}"},moduleInfo:function(e){return"var module="+JSON.stringify({id:e})}};return E.registerElement=function(e,t,r){E.registry(e,{template:t,script:function(){for(var e=Object.keys(r||{}),t=0,n=e.length;n>t;t+=1)this[e[t]]=r[e[t]]}})},{load:function(e,t,r){t(["@text!"+e+m],function(t){var n={deps:[],vars:["require","exports","module"],moduleId:e,template:"",moduleText:"",script:""};r.fromText(d(t,n))})},normalize:v,pluginBuilder:"./html-build"}});