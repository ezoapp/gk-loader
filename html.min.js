define(["module"],function(e){"use strict";function t(e){return c.parseFromString("<body>"+e+"</body>","text/html").querySelector("body")}function r(e,t){e.each(function(e,r){var n=r.getAttribute("href");n&&t.deps.push(f(n,t.moduleId+"/../")),v(r).remove()})}function n(e,t){var r,n=[],i={},o={context:"gk"};if(e.each(function(e,r){var i=r.getAttribute("src");i?n.push(f(i,t.moduleId+"/../")):t.script+=v(r).text()}),r=n.length,r&&(t.deps.push(n[r-1]),r>1)){for(var u=r-1;u>0;u-=1)i[n[u]]=[n[u-1]];o.shim=i,t.script="requirejs.config("+JSON.stringify(o)+");"+t.script}}function i(e,t){var n=v("<div>"+e.html()+"</div>");r(n.find("link"),t),t.template=p(h(n.html())),e.html(n.html())}function o(e,t){t.moduleText=y.requireVariables(t.deps)+";"+y.registerElement(t.template)+(e.length?e.text():"")}function u(e){return"(function(){"+y.moduleInfo(e.moduleId)+";"+h(e.script)+";define(function("+e.vars.join()+"){"+e.moduleText+"})}());"}function l(e,l){var c=t(e),m=v(c),s=m.find("link"),d=m.children("script"),a=m.children("element").first(),f=a.children("template").first(),p=a.children("script");return r(s,l),n(d,l),i(f,l),o(p,l),u(l)}var c=new window.DOMParser;!function(e){var t=window.DOMParser.prototype.parseFromString;try{if(e.parseFromString("","text/html"))return}catch(r){}e.parseFromString=function(e,r){if(/^\s*text\/html\s*(?:;|$)/i.test(r)){var n=document.implementation.createHTMLDocument("");return e.toLowerCase().indexOf("<!doctype")>-1?n.documentElement.innerHTML=e:n.body.innerHTML=e,n}return t.apply(this,arguments)}}(c);var m=".html",s=e.config(),d=s.lib,a=d.normalize,f=d.loadUrl,p=d.trimHtml,h=d.trimNewline,g=d.each,v=d.$,x=v.gk,y={requireVariables:function(e){var t=[];return g(e,function(e){t.push('require("'+e+'")')}),t.join(";")},registerElement:function(e){return"function registerElement(n,c){$.gk.registerElement(n,'"+e+"',c)}"},moduleInfo:function(e){return"var module="+JSON.stringify({id:e})}};return x.registerElement=function(e,t,r){x.registry(e,{template:t,script:function(){for(var e=Object.keys(r||{}),t=0,n=e.length;n>t;t+=1)this[e[t]]=r[e[t]]}})},{load:function(e,t,r){t(["@text!"+e+m],function(t){var n={deps:[],vars:["require","exports","module"],moduleId:e,template:"",moduleText:"",script:""};r.fromText(l(t,n))})},normalize:a,pluginBuilder:"./html-build"}});