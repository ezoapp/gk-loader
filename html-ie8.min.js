define(["module","./lib/simplehtmlparser.min"],function(t){"use strict";function e(t){return w.parse(t)}function n(t){return function(e){return e.tagName===t}}function r(t,e){p(t,function(t){var n=t.attribs.href;n&&e.deps.push(d(n,e.moduleId+"/../")),t.parentNode.removeChild(t)})}function i(t,e){var n,r=[],i={},o={context:"gk"};if(p(t,function(t){var n=t.attribs.src;n?r.push(d(n,e.moduleId+"/../")):e.script+=t.innerHTML()}),n=r.length,n&&(e.deps.push(r[n-1]),n>1)){for(var u=n-1;u>0;u-=1)i[r[u]]=[r[u-1]];o.shim=i,e.script="requirejs.config("+JSON.stringify(o)+");"+e.script}}function o(t,e){r(t.childNodes.filter(n("link")),e),e.template=t.innerHTML()}function u(t,e){var n="";p(t,function(t){n+=t.innerHTML()}),e.moduleText=L.requireVariables(e.deps)+";"+L.registerElement(e.template)+n}function s(t){return"(function(){"+L.moduleInfo(t.moduleId)+";"+m(t.script)+";define(function("+t.vars.join()+"){"+t.moduleText+"})}());"}function l(t,l){var a=e(t),c=a.childNodes,f=c.filter(n("link")),h=c.filter(n("script")),d=c.filter(n("element")),m=d.length?d[0].childNodes:[],p=m.filter(n("template")),g=m.filter(n("script"));return r(f,l),i(h,l),o(p.length?p[0]:"",l),u(g,l),s(l)}Array.prototype.filter||(Array.prototype.filter=function(t){if(void 0===this||null===this)throw new TypeError;var e=Object(this),n=e.length>>>0;if("function"!=typeof t)throw new TypeError;for(var r=[],i=arguments.length>=2?arguments[1]:void 0,o=0;n>o;o++)if(o in e){var u=e[o];t.call(i,u,o,e)&&r.push(u)}return r}),Array.prototype.indexOf||(Array.prototype.indexOf=function(t,e){if(void 0===this||null===this)throw new TypeError('"this" is null or not defined');var n=this.length>>>0;for(e=+e||0,1/0===Math.abs(e)&&(e=0),0>e&&(e+=n,0>e&&(e=0));n>e;e++)if(this[e]===t)return e;return-1});var a=".html",c=t.config(),f=c.lib,h=f.normalize,d=f.loadUrl,m=f.trimNewline,p=f.each,g=f.$,v=g.gk,b=function(){for(var t=["area","base","br","col","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"],e={},n=0,r=t.length;r>n;n++)e[t[n]]=!0;return e}(),y=new SimpleHtmlParser,N=function(){var t=arguments.length,e=this;t>1?(this.tagName=arguments[0],this.attribs=function(t){var e={};return p(t,function(t){e[t.name]=t.value}),e}(arguments[1]),this.childNodes=[],this.removeChild=function(t){var n=e.childNodes.indexOf(t);-1!==n&&e.childNodes.splice(n,1)},this.innerHTML=function(){var t="";return p(e.childNodes,function(e){t+=e.outerHTML()}),t},this.outerHTML=function(){var t=e.tagName,n="",r="";return p(Object.keys(e.attribs),function(t){n+=" "+t+'="'+e.attribs[t]+'"'}),r="<"+t+n+">"+e.innerHTML(),t.toLowerCase()in b||(r+="</"+t+">"),r}):(this.content=arguments[0],this.innerHTML=this.outerHTML=function(){return e.content})},T=function(){function t(){return[new N("ROOT",[])]}function e(t){return t[t.length-1]}function n(t,e){t.push(e)}function r(t){return t.pop()}function i(t,n,r,i){var o=e(t),u=new N(n,i);return u.parentNode=o,o.childNodes.push(u),u}function o(t,n){var r=e(t),i=new N(n);return i.parentNode=r,r.childNodes.push(i),i}return function(){this.parse=function(e){var u=t();return y.parse(e,{startElement:function(t,e,r){var o=i(u,t,e,r);t.toLowerCase()in b||"/>"===e.substr(e.length-2)||n(u,o)},endElement:function(){r(u)},characters:function(t){t=t.trim(),t&&o(u,t)}}),u[0]}}}(),w=new T,L={requireVariables:function(t){var e=[];return p(t,function(t){e.push('require("'+t+'")')}),e.join(";")},registerElement:function(t){return"function registerElement(n,c){$.gk.registerElement(n,'"+t+"',c)}"},moduleInfo:function(t){return"var module="+JSON.stringify({id:t})}};return v.registerElement=function(t,e,n){v.registry(t,{template:e,script:function(){for(var t=Object.keys(n||{}),e=0,r=t.length;r>e;e+=1)this[t[e]]=n[t[e]]}})},{load:function(t,e,n){e(["@text!"+t+a],function(e){var r={deps:[],vars:["require","exports","module"],moduleId:t,template:"",moduleText:"",script:""};n.fromText(l(e,r))})},normalize:h,pluginBuilder:"./html-build"}});